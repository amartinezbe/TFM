pais <- datosp$country
#print(val)
print(pais)
datosp <- datos1
sink(file="mf_lmcopiarv4.txt")
for (val in c("AT","BE","BG","CY","CZ", "DE",
"DK","EE","ES","FI","FR","GB", "GR",
"HR", "HU","IE","IT","LT", "LU",
"LV","MT","NL","PL","PT","RO",
"SE","SI", "SK",
"GLOBAL"))
{
#para tratar el fichero globalmente utilizo Val = "GLOBAL" con if
#val <- "GLOBAL"
if (val == "GLOBAL")
{ pais <- "GLOBAL"
datosp <- datos1}
else
{ datosp <- filter(datos1, isocntry == val)
pais <- datosp$country
}
pais <- datosp$country
#print(val)
print(pais)
#prueba
mbg1 <- lm(percepcion ~  edad  + sexo + veces_uso + confianza + deteccion + estudios, weights = wex,
data=datosp)
#print (summary(mbg1))
# ci_1 <- confint(mbg1)
#  ci_1
#correlaciones
# cor(datosp[, c("confianza", "edad", "sexo", "deteccion", "estudios", "veces_uso")], use = "complete")
stargazer(mbg1, title=paste("País: ",pais,".  Resultados modelo", sep=""),
align=TRUE, type="text",
dep.var.labels=c("Percepción problema para la democracia"),
column.labels=c("Modelo"),
ci=TRUE,
omit.stat = NULL,
omit.summary.stat = NULL,
# omit.stat=c("all"),
no.space=TRUE,
single.row=TRUE)
#summary(mbg1)
}
sink()
datosp <- datos1
sink(file="mf_lmcopiarv4.txt")
for (val in c("AT","BE","BG","CY","CZ", "DE",
"DK","EE","ES","FI","FR","GB", "GR",
"HR", "HU","IE","IT","LT", "LU",
"LV","MT","NL","PL","PT","RO",
"SE","SI", "SK",
"GLOBAL"))
{
#para tratar el fichero globalmente utilizo Val = "GLOBAL" con if
#val <- "GLOBAL"
if (val == "GLOBAL")
{ pais <- "GLOBAL"
datosp <- datos1}
else
{ datosp <- filter(datos1, isocntry == val)
pais <- datosp$country
}
pais <- datosp$country
#print(val)
#print(pais)
#prueba
mbg1 <- lm(percepcion ~  edad  + sexo + veces_uso + confianza + deteccion + estudios, weights = wex,
data=datosp)
#print (summary(mbg1))
# ci_1 <- confint(mbg1)
#  ci_1
#correlaciones
# cor(datosp[, c("confianza", "edad", "sexo", "deteccion", "estudios", "veces_uso")], use = "complete")
stargazer(mbg1, title=paste("País: ",pais,".  Resultados modelo", sep=""),
align=TRUE, type="text",
dep.var.labels=c("Percepción problema para la democracia"),
column.labels=c("Modelo"),
ci=TRUE,
omit.stat = NULL,
omit.summary.stat = NULL,
# omit.stat=c("all"),
no.space=TRUE,
single.row=TRUE)
#summary(mbg1)
}
sink()
sink(file="mf_lmcopiarv4.txt")
for (val in c("AT","BE","BG","CY","CZ", "DE",
"DK","EE","ES","FI","FR","GB", "GR",
"HR", "HU","IE","IT","LT", "LU",
"LV","MT","NL","PL","PT","RO",
"SE","SI", "SK",
"GLOBAL"))
{
#para tratar el fichero globalmente utilizo Val = "GLOBAL" con if
#val <- "GLOBAL"
if (val == "GLOBAL")
{ pais <- "GLOBAL"
datosp <- datos1}
else
{ datosp <- filter(datos1, isocntry == val)
pais <- datosp$country
}
pais <- datosp$country
#print(val)
#print(pais)
#prueba
mbg1 <- lm(percepcion ~  edad  + sexo + veces_uso + confianza + deteccion + estudios, weights = wex,
data=datosp)
#print (summary(mbg1))
# ci_1 <- confint(mbg1)
#  ci_1
#correlaciones
# cor(datosp[, c("confianza", "edad", "sexo", "deteccion", "estudios", "veces_uso")], use = "complete")
stargazer(mbg1, title=paste("País: ",pais,".  Resultados modelo", sep=""),
align=TRUE, type="text",
dep.var.labels=c("Percepción problema para la democracia"),
column.labels=c("Modelo"),
ci=TRUE,
omit.stat = NULL,
omit.summary.stat = NULL,
# omit.stat=c("all"),
no.space=TRUE,
single.row=TRUE)
#summary(mbg1)
}
sink()
datosp <- datos1
for (val in c("AT","BE","BG","CY","CZ", "DE",
"DK","EE","ES","FI","FR","GB", "GR",
"HR", "HU","IE","IT","LT", "LU",
"LV","MT","NL","PL","PT","RO",
"SE","SI", "SK",
"GLOBAL"))
{
#para tratar el fichero globalmente utilizo Val = "GLOBAL" con if
#val <- "GLOBAL"
if (val == "GLOBAL")
{ pais <- "GLOBAL"
datosp <- datos1}
else
{ datosp <- filter(datos1, isocntry == val)
pais <- datosp$country
}
#print(val)
#print(pais)
#prueba
mbg1 <- lm(percepcion ~  edad  + sexo + veces_uso + confianza + deteccion + estudios, weights = wex,
data=datosp)
#print (summary(mbg1))
# ci_1 <- confint(mbg1)
#  ci_1
#correlaciones
# cor(datosp[, c("confianza", "edad", "sexo", "deteccion", "estudios", "veces_uso")], use = "complete")
stargazer(mbg1, title=paste("País: ",pais,".  Resultados modelo", sep=""),
align=TRUE, type="text",
dep.var.labels=c("Percepción problema para la democracia"),
column.labels=c("Modelo"),
ci=TRUE,
omit.stat = NULL,
omit.summary.stat = NULL,
# omit.stat=c("all"),
no.space=TRUE,
single.row=TRUE)
#summary(mbg1)
}
q4_2ORD <- Recode(q4_2, "c(\"No, definitely not\" ) =  0;c( \"No, not really\" ) =  1;
c( \"Yes, to some extent\" ) =  2;c( \"Yes, definitely\" ) =  3 ;",
as.factor = TRUE)
global <- within(global, {
q4_2ORD <- Recode(q4_2, "c(\"No, definitely not\" ) =  0;c( \"No, not really\" ) =  1;
c( \"Yes, to some extent\" ) =  2;c( \"Yes, definitely\" ) =  3 ;",
as.factor = TRUE)
})
source('~/UOC/2020_2/TFM/Eurobarometro_FS_464/FS464_Step01_Configuration.R', encoding = 'UTF-8', echo=TRUE)
#ojo definicion del diretorio de trabajo de R
a<-"C:/Users/amart/Documents/UOC/2020_2/TFM/Eurobarometro_FS_464"
setwd(a)
library(dplyr)
library(tidyr)
library(haven)
library(Rcmdr)
library(car)
library(ggplot2, pos = 19)
library(abind, pos = 19)
library(gmodels)
library(reshape)
#fichero original en R. No se modifica.
FS464 <- read.table("FlashEurbarometer464.txt", header = TRUE,
sep = "\t", na.strings = "NA", dec = ".", strip.white = TRUE)
save("FS464", file ="FS464.RData")
#creaci?n fichero de trabajo
global <- FS464
save("global", file = "global.RData")
load("global.RData")
global <- within(global, {
d13 <- Recode(d13, "\"DK (SPONT.)\" = NA", as.factor = TRUE)
})
global <- within(global, {
q4_2 <- Recode(q4_2, "\"DK/NA\" = NA", as.factor = TRUE)
})
global <- within(global, {
q2 <- Recode(q2, "\"DK/NA\" = NA", as.factor = TRUE)
})
global <- within(global, {
q3 <- Recode(q3, "\"DK/NA\" = NA", as.factor = TRUE)
})
global <- within(global, {
q1_1 <- Recode(q1_1, "\"DK/NA\" = NA", as.factor = TRUE)
})
global <- within(global, {
q1_2 <- Recode(q1_2, "\"DK/NA\" = NA", as.factor = TRUE)
})
global <- within(global, {
q1_3 <- Recode(q1_3, "\"DK/NA\" = NA", as.factor = TRUE)
})
global <- within(global, {
q1_4 <- Recode(q1_4, "\"DK/NA\" = NA", as.factor = TRUE)
})
global <- within(global, {
q1_5 <- Recode(q1_5, "\"DK/NA\" = NA", as.factor = TRUE)
})
global <- within(global, {
q1_6 <- Recode(q1_6, "\"DK/NA\" = NA", as.factor = TRUE)
})
global <- within(global, {
q4_1 <- Recode(q4_1, "\"DK/NA\" = NA", as.factor = TRUE)
})
global <- within(global, {
sd2 <- Recode(sd2, "\"DK/NA\" = NA", as.factor = TRUE)
})
global <- within(global, {
sd3.1 <- Recode(sd3.1, "\"DK/NA\" = NA", as.factor = TRUE)
})
#sustituyo NOt mentioned por NA
global <- within(global, {
sd3.1 <- Recode(sd3.1, "\"Not mentioned\" = NA", as.factor = TRUE)
})
global <- within(global, {
sd3.2 <- Recode(sd3.2, "\"DK/NA\" = NA", as.factor = TRUE)
})
global <- within(global, {
sd3.2 <- Recode(sd3.2, "\"Not mentioned\" = NA", as.factor = TRUE)
})
global <- within(global, {
sd3.3 <- Recode(sd3.3, "\"DK/NA\" = NA", as.factor = TRUE)
})
global <- within(global, {
sd3.3 <- Recode(sd3.3, "\"Not mentioned\" = NA", as.factor = TRUE)
})
global <- within(global, {
sd3.4 <- Recode(sd3.4, "\"DK/NA\" = NA", as.factor = TRUE)
})
global <- within(global, {
sd3.4 <- Recode(sd3.4, "\"Not mentioned\" = NA", as.factor = TRUE)
})
global <- within(global, {
sd3.5 <- Recode(sd3.5, "\"DK/NA\" = NA", as.factor = TRUE)
})
global <- within(global, {
sd3.5 <- Recode(sd3.5, "\"Not mentioned\" = NA", as.factor = TRUE)
})
global <- within(global, {
sd1.1 <- Recode(sd1.1, "\"DK/NA\" = NA", as.factor = TRUE)
})
#sustituyo NOt mentioned por NA
global <- within(global, {
sd1.1 <- Recode(sd1.1, "\"Not mentioned\" = NA", as.factor = TRUE)
})
global <- within(global, {
sd1.2 <- Recode(sd1.2, "\"DK/NA\" = NA", as.factor = TRUE)
})
global <- within(global, {
sd1.2 <- Recode(sd1.2, "\"Not mentioned\" = NA", as.factor = TRUE)
})
global <- within(global, {
sd1.3 <- Recode(sd1.3, "\"DK/NA\" = NA", as.factor = TRUE)
})
global <- within(global, {
sd1.3 <- Recode(sd1.3, "\"Not mentioned\" = NA", as.factor = TRUE)
})
global <- within(global, {
sd1.4 <- Recode(sd1.4, "\"DK/NA\" = NA", as.factor = TRUE)
})
global <- within(global, {
sd1.4 <- Recode(sd1.4, "\"Not mentioned\" = NA", as.factor = TRUE)
})
global <- within(global, {
sd1.5 <- Recode(sd1.5, "\"DK/NA\" = NA", as.factor = TRUE)
})
global <- within(global, {
sd1.5 <- Recode(sd1.5, "\"Not mentioned\" = NA", as.factor = TRUE)
})
global <- within(global, {
sd1.6 <- Recode(sd1.6, "\"DK/NA\" = NA", as.factor = TRUE)
})
global <- within(global, {
sd1.6 <- Recode(sd1.6, "\"Not mentioned\" = NA", as.factor = TRUE)
})
global <- within(global, {
sd1.7 <- Recode(sd1.7, "\"DK/NA\" = NA", as.factor = TRUE)
})
global <- within(global, {
sd1.7 <- Recode(sd1.7, "\"Not mentioned\" = NA", as.factor = TRUE)
})
global <- within(global, {
sd1.8 <- Recode(sd1.8, "\"DK/NA\" = NA", as.factor = TRUE)
})
global <- within(global, {
sd1.8 <- Recode(sd1.8, "\"Not mentioned\" = NA", as.factor = TRUE)
})
#NO usar sd1.9 a sd1.1. De todas formas las manipulo
global <- within(global, {
sd1.9 <- Recode(sd1.9, "\"Not mentioned\" = NA", as.factor = TRUE)
})
global <- within(global, {
sd1.9 <- Recode(sd1.9, "\"Other (DO NOT READ OUT)\" = NA", as.factor = TRUE)
})
global <- within(global, {
sd1.10 <- Recode(sd1.10, "\"Not mentioned\" = NA", as.factor = TRUE)
})
global <- within(global, {
sd1.10 <- Recode(sd1.10, "\"None of these (DO NOT READ OUT)\" = NA", as.factor = TRUE)
})
global <- within(global, {
sd1.11 <- Recode(sd1.11, "\"Not mentioned\" = NA", as.factor = TRUE)
})
global <- within(global, {
sd1.11 <- Recode(sd1.11, "\"DK/NA\" = NA", as.factor = TRUE)
})
global <- within(global, {
d4r2 <- Recode(d4r2, "c(\"DK\" ) =  NA;c( \"Refusal\" ) =  NA",
as.factor = TRUE)
})
#d5 trabajo
global <- within(global, {
d5r <- Recode(d5r, "c(\"DK\" ) =  NA;c( \"Refusal\" ) =  NA",
as.factor = TRUE)
})
save("global", file = "global.RData")
global <- within(global, {
q2 <- factor(q2, levels = c("Seldom or Never", "Several times a month",
"At least once a week", "Every day or almost everyday"), ordered = TRUE)
})
global <- within(global, {
q3 <- factor(q3, levels=c("Not at all confident", "Not very confident",
"Somewhat confident", "Very confident"),ordered = TRUE)
})
global <- within(global, {
q4_2 <- factor(q4_2, levels = c("No, definitely not", "No, not really",
"Yes, to some extent","Yes, definitely"), ordered = TRUE)
})
global <- within(global, {
q4_1 <- factor(q4_1, levels = c("No, definitely not", "No, not really",
"Yes, to some extent","Yes, definitely"), ordered = TRUE)
})
save("global", file = "global.RData")
global <- within(global, {
q1_1 <- factor(q1_1, levels = c("Do not trust at all","Tend not to trust",
"Tend to trust","Totally trust"), ordered = TRUE)
})
global <- within(global, {
q1_2 <- factor(q1_2, levels = c("Do not trust at all","Tend not to trust",
"Tend to trust","Totally trust"), ordered = TRUE)
})
global <- within(global, {
q1_3 <- factor(q1_3, levels = c("Do not trust at all","Tend not to trust",
"Tend to trust","Totally trust"), ordered = TRUE)
})
global <- within(global, {
q1_4 <- factor(q1_4, levels = c("Do not trust at all","Tend not to trust",
"Tend to trust","Totally trust"), ordered = TRUE)
})
global <- within(global, {
q1_5 <- factor(q1_5, levels = c("Do not trust at all","Tend not to trust",
"Tend to trust","Totally trust"), ordered = TRUE)
})
global <- within(global, {
q1_6 <- factor(q1_6, levels = c("Do not trust at all","Tend not to trust",
"Tend to trust","Totally trust"), ordered = TRUE)
})
save("global", file = "global.RData")
global <- within(global, {
sd2 <- factor(sd2, levels = c("Seldom or Never","Several times a month",
"At least once a week","Every day or almost everyday"), ordered = TRUE)
})
global <- within(global, {
sd3.1n <- Recode(sd3.1, "c(\"Read or listen to what is shared by others\") = 1",
as.numeric=TRUE)
})
global <- within(global, {
sd3.2n <- Recode(sd3.2, "c(\"Share things you found yourself\") = 1",
as.numeric=TRUE)
})
global <- within(global, {
sd3.3n <- Recode(sd3.3, "c(\"Share things others have shared with you\") = 1",
as.numeric=TRUE)
})
global <- within(global, {
sd1.2n <- Recode(sd1.2, "c(\"Online newspapers and news magazines\") = 1",
as.numeric=TRUE)
})
global <- within(global, {
sd1.4n <- Recode(sd1.4, "c(\"Online social networks and messaging apps\") = 1",
as.numeric=TRUE)
})
global <- within(global, {
sd1.8n <- Recode(sd1.8, "c(\"Video hosting websites\") = 1",
as.numeric=TRUE)
})
global <- within(global, {
sd1.2n <- Recode(sd1.2n, "NA=0", as.factor = TRUE)
})
global <- within(global, {
sd1.4n <- Recode(sd1.4n, "NA=0", as.factor = TRUE)
})
global <- within(global, {
sd1.8n <- Recode(sd1.8n, "NA=0", as.factor = TRUE)
})
global <- within(global, {
sd3.1n <- Recode(sd3.1n, "NA=0", as.factor = TRUE)
})
global <- within(global, {
sd3.2n <- Recode(sd3.2n, "NA=0", as.factor = TRUE)
})
global <- within(global, {
sd3.3n <- Recode(sd3.3n, "NA=0", as.factor = TRUE)
})
global <- within(global, {
q4_2ORD <- Recode(q4_2, "c(\"No, definitely not\" ) =  0;c( \"No, not really\" ) =  1;
c( \"Yes, to some extent\" ) =  2;c( \"Yes, definitely\" ) =  3 ;",
as.factor = TRUE)
})
save("global", file = "global.RData")
#ordeno la variable d1r2 "edad" NO sé si es necesario
global <- within(global, {
d1r2 <- factor(d1r2, levels = c("15 - 24 years","25 - 34 years",
"35 - 44 years","45 - 54 years",
"55 - 64 years",
"65 years and older"), ordered = TRUE)
})
#ordeno la variable d4r2 "edad en que dejo los estudios"
global <- within(global, {
d4r2 <- factor(d4r2, levels = c("No full-time education","Up to 15",
"16-19","20 years and older",
"Still Studying"), ordered = TRUE)
})
#ordeno la variable d13 "lugar de residencia"
global <- within(global, {
d13 <- factor(d13, levels = c("Rural area or village","Small or middle sized town",
"Large town"), ordered = TRUE)
})
#creacion variable binaria yes= 1, No= 0
global <- within(global, {
q4_2BIN <- Recode(q4_2, "c(\"No, definitely not\" ) =  0;c( \"No, not really\" ) =  0;c( \"Yes, to some extent\" ) =  1;c( \"Yes, definitely\" ) =  1 ;",
as.factor = TRUE)
})
#creacion variable binaria yes= 1, No= 0
#creaci?n variable ideologia gobierno
global <- within(global, {
idgov <- Recode(isocntry, "c(\"AT\") = 8;
c(\"BE\") = 6;
c(\"BG\") = 7;
c(\"CY\") = 6;
c(\"CZ\") = 4;
c(\"DE\") = 5;
c(\"DK\") = 7;
c(\"EE\") = 6;
c(\"ES\") = 7;
c(\"FI\") = 6;
c(\"FR\") = 5;
c(\"GB\") = 6;
c(\"GR\") = 4;
c(\"HR\") = 6;
c(\"HU\") = 7;
c(\"IE\") = 6;
c(\"IT\") = 6;
c(\"LT\") = 5;
c(\"LU\") = 5;
c(\"LV\") = 6;
c(\"MT\") = 4;
c(\"NL\") = 6;
c(\"PL\") = 8;
c(\"PT\") = 4;
c(\"RO\") = 4;
c(\"SE\") = 4;
c(\"SI\") = 6;
c(\"SK\") = 5",
as.factor = TRUE)
})
global <- within(global, {
idcom <- Recode(d12es, "c(\"Andalucia\") = 4;
c(\"Aragon\") = 4;
c(\"Asturias\") = 4;
c(\"Baleares\") = 4;
c(\"Canarias\") = 7;
c(\"Cantabria\") = 4;
c(\"Castilla/La Mancha\") = 4;
c(\"Castilla/Leon\") = 7;
c(\"Cataluna\") = 2;
c(\"Extremadura\") = 4;
c(\"Galicia\") = 7;
c(\"Madrid\") = 7;
c(\"Murcia\") = 7;
c(\"Navarra\") = 4;
c(\"Pais Vasco\") = 7;
c(\"Rioja\") = 7;
c(\"Valencia\") = 4",
as.factor = TRUE)
})
save("global", file = "global.RData")
